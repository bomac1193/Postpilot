<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PostPilot - AI-Powered Content Planner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">‚úß</span>
          <div class="logo-text">
            <h1>PostPilot</h1>
            <p class="logo-subtitle">Social Alchemy Studio</p>
          </div>
        </div>
        <nav class="nav" id="mainNav">
          <button class="nav-btn" data-view="dashboard">Dashboard</button>
          <button class="nav-btn" data-view="content">Content Library</button>
          <button class="nav-btn" data-view="collections">Collections</button>
          <button class="nav-btn active" data-view="grid">Grid Planner</button>
          <button class="nav-btn" data-view="analytics">AI Analytics</button>
        </nav>
        <div class="user-actions">
          <button class="btn btn-secondary" id="connectSocial">Connect Accounts</button>
          <div class="user-profile" id="userProfile">
            <span class="user-name">Guest</span>
            <button class="btn btn-logout" id="logoutBtn">Logout</button>
          </div>
        </div>
      </div>
      <p class="header-tagline">Where disciplined craft meets a touch of magic</p>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">

      <!-- Dashboard View -->
      <div class="view" id="dashboardView" style="display: none;">
        <h2>Dashboard</h2>
        <div class="dashboard-grid">
          <div class="stat-card">
            <h3>Total Content</h3>
            <p class="stat-number" id="totalContent">0</p>
          </div>
          <div class="stat-card">
            <h3>Active Grids</h3>
            <p class="stat-number" id="totalGrids">0</p>
          </div>
          <div class="stat-card">
            <h3>Scheduled Posts</h3>
            <p class="stat-number" id="scheduledPosts">0</p>
          </div>
          <div class="stat-card">
            <h3>Avg AI Score</h3>
            <p class="stat-number" id="avgScore">0</p>
          </div>
        </div>
      </div>

      <!-- Content Library View -->
      <div class="view" id="contentView" style="display: none;">
        <div class="view-header">
          <h2>Content Library</h2>
          <button class="btn btn-primary" id="uploadContentBtn">
            <span>üì§</span> Upload Content
          </button>
        </div>

        <div class="filters">
          <select id="platformFilter" class="filter-select">
            <option value="">All Platforms</option>
            <option value="instagram">Instagram</option>
            <option value="tiktok">TikTok</option>
          </select>
          <select id="statusFilter" class="filter-select">
            <option value="">All Status</option>
            <option value="draft">Draft</option>
            <option value="scheduled">Scheduled</option>
            <option value="published">Published</option>
          </select>
        </div>

        <div class="content-grid" id="contentLibrary">
          <!-- Content items will be loaded here -->
        </div>
      </div>

      <!-- Collections View -->
      <div class="view" id="collectionsView" style="display: none;">
        <div class="view-header">
          <h2>Collections</h2>
          <div class="collection-actions">
            <button class="btn btn-primary" id="createCollectionBtn">+ New Collection</button>
          </div>
        </div>

        <div class="collection-stats" id="collectionStatsContainer">
          <!-- Stats will be loaded here -->
        </div>

        <div class="collection-layout">
          <div class="collection-sidebar">
            <h3>My Collections</h3>
            <div id="collectionsListContainer">
              <!-- Collections list will be loaded here -->
            </div>
          </div>

          <div class="collection-main">
            <div class="collection-toolbar">
              <select id="collectionSelector" class="filter-select">
                <option value="">Select Collection...</option>
              </select>
              <div class="collection-toolbar-actions">
                <button class="btn btn-sm btn-secondary" id="scheduleCollectionBtn">üìÖ Schedule</button>
                <button class="btn btn-sm btn-success" id="postCollectionBtn">üöÄ Post Now</button>
                <button class="btn btn-sm btn-secondary" id="duplicateCollectionBtn">üìã Duplicate</button>
                <button class="btn btn-sm btn-danger" id="deleteCollectionBtn">üóëÔ∏è Delete</button>
              </div>
            </div>

            <div id="collectionDetails">
              <p class="text-muted">Select a collection to view details</p>
            </div>

            <div id="collectionGridContainer">
              <p class="text-muted">Select a collection to manage content</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Grid Planner View -->
      <div class="view active" id="gridView">
        <div class="view-header">
          <h2>Grid Planner</h2>
          <div class="grid-actions">
            <select id="gridSelector" class="filter-select">
              <option value="">Select a grid...</option>
            </select>
            <button class="btn btn-primary" id="createGridBtn">+ New Grid</button>
          </div>
        </div>

        <div class="grid-controls">
          <div class="control-group">
            <label>Grid Name:</label>
            <input type="text" id="gridName" placeholder="My Instagram Feed" class="input">
          </div>
          <div class="control-group">
            <label>Platform:</label>
            <select id="gridPlatform" class="filter-select">
              <option value="instagram">Instagram</option>
              <option value="tiktok">TikTok</option>
            </select>
          </div>
          <div class="control-group">
            <label>Columns:</label>
            <input type="number" id="gridColumns" min="1" max="9" value="3" class="input">
          </div>
          <div class="control-group">
            <button class="btn btn-secondary" id="addRowBtn">+ Add Row</button>
            <button class="btn btn-secondary" id="removeRowBtn">- Remove Row</button>
          </div>
        </div>

        <div class="grid-container" id="gridContainer">
          <div class="instagram-grid" id="instagramGrid">
            <!-- Grid cells will be generated here -->
          </div>
        </div>

        <div class="grid-preview-actions">
          <button class="btn btn-primary" id="saveGridBtn">üíæ Save Grid</button>
          <button class="btn btn-secondary" id="exportGridBtn">üì∏ Export Preview</button>
        </div>
      </div>

      <!-- AI Analytics View -->
      <div class="view" id="analyticsView" style="display: none;">
        <h2>AI Analytics & Insights</h2>

        <div class="analytics-section">
          <h3>Content Performance Predictions</h3>
          <div id="analyticsContent" class="analytics-grid">
            <!-- AI scores and analytics will appear here -->
          </div>
        </div>

        <div class="analytics-section">
          <h3>Best Posting Times</h3>
          <div class="insights-card">
            <p>Based on AI analysis of your content and platform trends:</p>
            <ul id="postingTimesList">
              <li>Instagram: Weekdays 11AM-1PM, 7PM-9PM</li>
              <li>TikTok: Tuesday 9AM, Thursday 12PM, Friday 5AM</li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Upload Modal -->
  <div class="modal" id="uploadModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Upload Content</h3>
        <button class="modal-close" id="closeUploadModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="uploadForm" enctype="multipart/form-data">
          <div class="form-group">
            <label>Media File</label>
            <input type="file" id="mediaFile" name="media" accept="image/*,video/*" required class="input">
            <div id="filePreview" class="file-preview"></div>
          </div>

          <div class="form-group">
            <label>Title</label>
            <input type="text" id="contentTitle" name="title" placeholder="Give your content a title" class="input">
          </div>

          <div class="form-group">
            <label>Caption</label>
            <textarea id="contentCaption" name="caption" rows="4" placeholder="Write your caption..." class="input"></textarea>
            <button type="button" class="btn btn-secondary btn-sm" id="generateCaptionBtn">‚ú® AI Generate</button>
          </div>

          <div class="form-group">
            <label>Platform</label>
            <select id="contentPlatform" name="platform" class="filter-select">
              <option value="instagram">Instagram</option>
              <option value="tiktok">TikTok</option>
            </select>
          </div>

          <div class="form-group">
            <label>Media Type</label>
            <select id="contentMediaType" name="mediaType" class="filter-select">
              <option value="image">Image</option>
              <option value="video">Video</option>
              <option value="carousel">Carousel</option>
            </select>
          </div>

          <div class="ai-suggestions" id="aiSuggestions" style="display: none;">
            <h4>ü§ñ AI Suggestions</h4>
            <p id="suggestionText"></p>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Upload & Analyze</button>
            <button type="button" class="btn btn-secondary" id="cancelUpload">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Content Detail Modal -->
  <div class="modal" id="contentModal">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3>Content Analysis</h3>
        <button class="modal-close" id="closeContentModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="content-detail">
          <div class="content-preview">
            <img id="contentPreviewImage" src="" alt="Content Preview">
          </div>
          <div class="content-info">
            <h4 id="contentDetailTitle"></h4>
            <p id="contentDetailCaption"></p>

            <div class="ai-scores">
              <h4>AI Performance Scores</h4>
              <div class="score-item">
                <span>Virality Potential</span>
                <div class="score-bar">
                  <div class="score-fill" id="scoreVirality"></div>
                  <span class="score-value" id="scoreViralityValue">0</span>
                </div>
              </div>
              <div class="score-item">
                <span>Engagement Prediction</span>
                <div class="score-bar">
                  <div class="score-fill" id="scoreEngagement"></div>
                  <span class="score-value" id="scoreEngagementValue">0</span>
                </div>
              </div>
              <div class="score-item">
                <span>Aesthetic Quality</span>
                <div class="score-bar">
                  <div class="score-fill" id="scoreAesthetic"></div>
                  <span class="score-value" id="scoreAestheticValue">0</span>
                </div>
              </div>
              <div class="score-item">
                <span>Trend Alignment</span>
                <div class="score-bar">
                  <div class="score-fill" id="scoreTrend"></div>
                  <span class="score-value" id="scoreTrendValue">0</span>
                </div>
              </div>
              <div class="score-item overall">
                <span>Overall Score</span>
                <div class="score-bar">
                  <div class="score-fill" id="scoreOverall"></div>
                  <span class="score-value" id="scoreOverallValue">0</span>
                </div>
              </div>
            </div>

            <div class="ai-recommendations">
              <h4>üìä AI Recommendations</h4>
              <div id="recommendationsList"></div>
            </div>

            <div class="content-actions">
              <button class="btn btn-primary" id="addToGridBtn">Add to Grid</button>
              <button class="btn btn-secondary" id="analyzeAgainBtn">Re-analyze</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Social Accounts Modal -->
  <div class="modal" id="socialAccountsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Connect Social Accounts</h3>
        <button class="modal-close" id="closeSocialModal">&times;</button>
      </div>
      <div class="modal-body">
        <p class="text-muted" style="margin-bottom: 1.5rem;">
          Connect your Instagram and TikTok accounts to enable direct posting and scheduling.
        </p>

        <!-- Instagram Connection -->
        <div class="social-account-card">
          <div class="social-account-header">
            <div class="social-account-icon instagram-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </div>
            <div class="social-account-info">
              <h4>Instagram</h4>
              <p class="status-text" id="instagramStatus">Not connected</p>
            </div>
          </div>
          <div class="social-account-actions">
            <button class="btn btn-primary" id="connectInstagramBtn">Connect</button>
            <button class="btn btn-danger" id="disconnectInstagramBtn" style="display: none;">Disconnect</button>
          </div>
        </div>

        <!-- TikTok Connection -->
        <div class="social-account-card">
          <div class="social-account-header">
            <div class="social-account-icon tiktok-icon">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
              </svg>
            </div>
            <div class="social-account-info">
              <h4>TikTok</h4>
              <p class="status-text" id="tiktokStatus">Not connected</p>
            </div>
          </div>
          <div class="social-account-actions">
            <button class="btn btn-primary" id="connectTikTokBtn">Connect</button>
            <button class="btn btn-danger" id="disconnectTikTokBtn" style="display: none;">Disconnect</button>
          </div>
        </div>

        <div class="social-help" style="margin-top: 1.5rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
          <p style="font-size: 0.875rem; color: #6b7280; margin: 0;">
            <strong>Note:</strong> You'll need to set up API credentials in your .env file first.
            Check the SETUP_INSTRUCTIONS.md file for detailed setup steps.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div class="modal" id="authModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="authModalTitle">Login</h3>
        <button class="modal-close" id="closeAuthModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="authForm">
          <div class="form-group" id="nameGroup" style="display: none;">
            <label>Name</label>
            <input type="text" id="authName" placeholder="Your name" class="input">
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="authEmail" placeholder="your@email.com" required class="input">
          </div>
          <div class="form-group">
            <label>Password</label>
            <input type="password" id="authPassword" placeholder="Password" required class="input">
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary" id="authSubmitBtn">Login</button>
          </div>

          <div class="auth-divider">
            <span>or</span>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-google" id="googleSignInBtn">
              <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px;">
                <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/>
                <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
                <path fill="#FBBC05" d="M3.964 10.707c-.18-.54-.282-1.117-.282-1.707s.102-1.167.282-1.707V4.961H.957C.347 6.175 0 7.55 0 9s.348 2.825.957 4.039l3.007-2.332z"/>
                <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.961L3.964 7.293C4.672 5.163 6.656 3.58 9 3.58z"/>
              </svg>
              Continue with Google
            </button>
          </div>

          <p class="auth-switch">
            <span id="authSwitchText">Don't have an account?</span>
            <a href="#" id="authSwitchLink">Sign up</a>
          </p>
        </form>
      </div>
    </div>
  </div>

  <!-- Collection Create Modal -->
  <div class="modal" id="collectionModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Create New Collection</h3>
        <button class="modal-close" id="closeCollectionModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="collectionForm">
          <div class="form-group">
            <label>Collection Name *</label>
            <input type="text" id="collectionName" placeholder="e.g., Holiday Campaign 2024" required class="input">
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="collectionDescription" placeholder="Describe this collection..." class="input" rows="3"></textarea>
          </div>
          <div class="form-group">
            <label>Platform *</label>
            <select id="collectionPlatform" required class="input">
              <option value="instagram">Instagram</option>
              <option value="tiktok">TikTok</option>
              <option value="both">Both</option>
            </select>
          </div>
          <div class="form-group">
            <label>Grid Type *</label>
            <select id="collectionGridType" required class="input">
              <option value="standard">Standard Grid (Photos)</option>
              <option value="reel">Reel Grid (Videos)</option>
            </select>
            <small class="text-muted">Standard grids accept images, Reel grids accept videos</small>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Grid Columns</label>
              <input type="number" id="collectionColumns" value="3" min="1" max="9" class="input">
            </div>
            <div class="form-group">
              <label>Grid Rows</label>
              <input type="number" id="collectionRows" value="3" min="1" max="20" class="input">
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Create Collection</button>
            <button type="button" class="btn btn-secondary" onclick="document.getElementById('collectionModal').classList.remove('active')">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Schedule Collection Modal -->
  <div class="modal" id="scheduleModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Schedule Collection</h3>
        <button class="modal-close" id="closeScheduleModal">&times;</button>
      </div>
      <div class="modal-body">
        <form id="scheduleForm">
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="scheduleEnabled">
              <span>Enable Scheduling</span>
            </label>
          </div>

          <div class="form-group">
            <label>Start Date & Time</label>
            <input type="datetime-local" id="scheduleStartDate" class="input">
          </div>

          <div class="form-group">
            <label>End Date (Optional)</label>
            <input type="datetime-local" id="scheduleEndDate" class="input">
          </div>

          <div class="form-group">
            <label>Posting Interval</label>
            <select id="scheduleInterval" class="input">
              <option value="daily">Daily</option>
              <option value="every-other-day">Every Other Day</option>
              <option value="weekly">Weekly</option>
              <option value="custom">Custom (hours)</option>
            </select>
          </div>

          <div class="form-group" id="customIntervalGroup" style="display: none;">
            <label>Custom Interval (hours)</label>
            <input type="number" id="customIntervalHours" min="1" max="168" class="input">
          </div>

          <div class="form-group">
            <label>Posting Time</label>
            <div class="form-row">
              <input type="number" id="postingHour" placeholder="Hour (0-23)" min="0" max="23" class="input">
              <input type="number" id="postingMinute" placeholder="Minute (0-59)" min="0" max="59" class="input">
            </div>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="autoPostEnabled">
              <span>Enable Auto-Posting</span>
            </label>
            <small class="form-hint">When enabled, posts will be published automatically at scheduled times</small>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Save Schedule</button>
            <button type="button" class="btn btn-secondary" onclick="document.getElementById('scheduleModal').classList.remove('active')">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
  <script src="/js/collections.js"></script>
</body>
</html>
